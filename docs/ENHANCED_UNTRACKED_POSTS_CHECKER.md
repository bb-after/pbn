# Enhanced Untracked Posts Checker

## Overview

The enhanced untracked posts checker analyzes WordPress posts from the last 7 days and automatically categorizes them as manual or automated content based on content analysis.

## Content Analysis Rules

### Manual Posts (autogenerated = 0)

- **Contains 1 or more hyperlinks** in the content
- **Default case** for posts with 0 hyperlinks and 0 images
- **Default case** for posts with 0 hyperlinks and multiple images

### Automated Posts (autogenerated = 1)

- **No hyperlinks AND exactly 1 image** in the content
- Still marked as `retroactively_imported = 1`

## Performance Optimizations

### 7-Day Rolling Window

- Only checks posts from the last 7 days instead of all posts
- Significantly faster execution (seconds vs minutes)
- Reduces API calls to WordPress sites
- Scales better as sites grow

### Enhanced Tracking

- Better categorization of content type
- Detailed analysis logging
- Comprehensive import notes with reasoning

## Usage

### Command Line Options

```bash
# Discovery mode (analyze only)
node scripts/findManualSuperstarPosts.js

# Import mode (analyze and import)
node scripts/findManualSuperstarPosts.js --import

# Filter by specific site
node scripts/findManualSuperstarPosts.js --site=example.com --import
```

### Scheduled Execution

- **Runs twice daily** at 8:00 AM and 8:00 PM
- **Cron schedule**: `0 8,20 * * * /path/to/run-manual-posts-check.sh`
- **Logs**: Stored in `/logs/untracked-posts-check.log`

## Output Files

### JSON Results

- **Filename**: `untracked_posts_[found|imported]_[timestamp].json`
- **Structure**:

```json
{
  "site_id": 123,
  "domain": "example.com",
  "manual_posts_count": 2,
  "automated_posts_count": 3,
  "total_untracked": 5,
  "posts": [
    {
      "post_id": 456,
      "title": "Example Post",
      "is_manual": true,
      "analysis_reason": "Contains 3 hyperlink(s) - indicates manual content",
      "imported": true
    }
  ]
}
```

## Database Impact

### New/Updated Columns

- `wordpress_post_id`: Links to WordPress post ID
- `retroactively_imported`: Always 1 for script imports
- `autogenerated`: 0 for manual, 1 for automated (based on analysis)
- `notes`: Detailed import reasoning and timestamp

### Benefits

- **Accurate categorization** of manual vs automated content
- **Efficient processing** with 7-day window
- **Comprehensive tracking** of all untracked posts
- **Detailed audit trail** in notes field

## Monitoring

### Log Files

- Check `/logs/untracked-posts-check.log` for execution details
- Monitor for API errors or database issues
- Review analysis results for accuracy

### Expected Behavior

- Most sites should show 0 untracked posts during regular runs
- New manual posts will be detected and categorized correctly
- Automated posts missed by main system will be caught and imported
